2025-04-10 11:44:27,705 - INFO - [61326] - root - Initializing application
2025-04-10 11:44:27,705 - INFO - [61326] - root - Setting up database connection to postgresql://postgres:7987@localhost:5432/Voice_Recognition
2025-04-10 11:44:27,793 - INFO - [61326] - root - Database setup successful
2025-04-10 11:44:27,793 - INFO - [61326] - root - Starting Flask server on port 8586
2025-04-10 11:44:27,819 - WARNING - [61326] - werkzeug -  * Debugger is active!
2025-04-10 11:44:27,826 - INFO - [61326] - werkzeug -  * Debugger PIN: 137-071-496
2025-04-10 11:44:27,883 - INFO - [61326] - root - Serving index page
2025-04-10 11:44:27,887 - INFO - [61326] - werkzeug - 127.0.0.1 - - [10/Apr/2025 11:44:27] "GET / HTTP/1.1" 200 -
2025-04-10 11:44:31,878 - INFO - [61326] - root - Received upload request
2025-04-10 11:44:31,883 - INFO - [61326] - root - Upload parameters: language=en, streaming=False,conversational mode=on
2025-04-10 11:44:31,885 - INFO - [61326] - root - File saved to uploads/602038fb20bf4c51937c1026c94e2676.m4a
2025-04-10 11:44:31,885 - INFO - [61326] - root - Starting batch processing mode
2025-04-10 11:44:31,886 - INFO - [61326] - root - Setting up database connection to postgresql://postgres:7987@localhost:5432/Voice_Recognition
2025-04-10 11:44:31,941 - INFO - [61326] - root - Database setup successful
2025-04-10 11:44:31,941 - INFO - [61326] - root - Database session initialized
2025-04-10 11:44:31,941 - INFO - [61326] - root - Starting audio preprocessing
2025-04-10 11:44:34,167 - INFO - [61326] - root - Audio preprocessing completed in 2.2258 seconds
2025-04-10 11:44:34,167 - INFO - [61326] - root - Starting audio transcription in en
2025-04-10 11:44:34,168 - INFO - [61326] - root - Starting parallel audio processing with 3 workers
2025-04-10 11:44:34,168 - INFO - [61326] - root - Splitting audio file /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmpbkqvmlhb/processed_audio.wav into chunks of 20000ms
2025-04-10 11:44:34,178 - INFO - [61326] - root - Created 3 audio chunks
2025-04-10 11:44:34,190 - INFO - [61326] - root - Processing audio chunk: /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmpbkqvmlhb/processed_audio.wav_chunk_0.wav
2025-04-10 11:44:34,190 - INFO - [61326] - root - Processing audio chunk: /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmpbkqvmlhb/processed_audio.wav_chunk_20000.wav
2025-04-10 11:44:34,191 - INFO - [61326] - root - Processing audio chunk: /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmpbkqvmlhb/processed_audio.wav_chunk_40000.wav
2025-04-10 11:44:45,701 - INFO - [61326] - httpx - HTTP Request: POST https://api.groq.com/openai/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-04-10 11:44:45,706 - INFO - [61326] - root - Removed chunk /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmpbkqvmlhb/processed_audio.wav_chunk_40000.wav
2025-04-10 11:44:46,717 - INFO - [61326] - httpx - HTTP Request: POST https://api.groq.com/openai/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-04-10 11:44:46,718 - INFO - [61326] - root - Removed chunk /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmpbkqvmlhb/processed_audio.wav_chunk_20000.wav
2025-04-10 11:44:47,238 - INFO - [61326] - httpx - HTTP Request: POST https://api.groq.com/openai/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-04-10 11:44:47,241 - INFO - [61326] - root - Removed chunk /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmpbkqvmlhb/processed_audio.wav_chunk_0.wav
2025-04-10 11:44:47,241 - INFO - [61326] - root - Chunk 0 processing completed
2025-04-10 11:44:47,242 - INFO - [61326] - root - Chunk 1 processing completed
2025-04-10 11:44:47,242 - INFO - [61326] - root - Chunk 2 processing completed
2025-04-10 11:44:47,242 - INFO - [61326] - root - Parallel processing completed, combined text length: 237
2025-04-10 11:44:47,242 - INFO - [61326] - root - Audio transcription completed in 13.0750 seconds, text length: 237
2025-04-10 11:44:47,243 - INFO - [61326] - root - Starting LLM processing
2025-04-10 11:44:47,546 - INFO - [61326] - root - Serving index page
2025-04-10 11:44:47,547 - INFO - [61326] - werkzeug - 127.0.0.1 - - [10/Apr/2025 11:44:47] "GET / HTTP/1.1" 200 -
2025-04-10 11:44:50,896 - INFO - [61326] - httpx - HTTP Request: POST https://api.fireworks.ai/inference/v1/completions "HTTP/1.1 200 OK"
2025-04-10 11:44:50,898 - INFO - [61326] - root - LLM refining processing completed in 3.6559 seconds
2025-04-10 11:44:50,899 - INFO - [61326] - root - Starting LLM processing
2025-04-10 11:44:51,863 - INFO - [61326] - root - Received upload request
2025-04-10 11:44:51,865 - INFO - [61326] - root - Upload parameters: language=en, streaming=False,conversational mode=false
2025-04-10 11:44:51,866 - INFO - [61326] - root - File saved to uploads/781bd142692744f3990fdb45e9dcadcb.m4a
2025-04-10 11:44:51,866 - INFO - [61326] - root - Starting batch processing mode
2025-04-10 11:44:51,866 - INFO - [61326] - root - Setting up database connection to postgresql://postgres:7987@localhost:5432/Voice_Recognition
2025-04-10 11:44:51,909 - INFO - [61326] - root - Database setup successful
2025-04-10 11:44:51,909 - INFO - [61326] - root - Database session initialized
2025-04-10 11:44:51,909 - INFO - [61326] - root - Starting audio preprocessing
2025-04-10 11:44:52,592 - INFO - [61326] - httpx - HTTP Request: POST https://api.fireworks.ai/inference/v1/completions "HTTP/1.1 200 OK"
2025-04-10 11:44:52,599 - INFO - [61326] - root - LLM translation processing completed in 1.7005 seconds
2025-04-10 11:44:52,599 - INFO - [61326] - root - Starting LLM processing
2025-04-10 11:44:52,648 - INFO - [61326] - root - Audio preprocessing completed in 0.7382 seconds
2025-04-10 11:44:52,648 - INFO - [61326] - root - Starting audio transcription in en
2025-04-10 11:44:52,648 - INFO - [61326] - root - Starting parallel audio processing with 3 workers
2025-04-10 11:44:52,648 - INFO - [61326] - root - Splitting audio file /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmppuftri6j/processed_audio.wav into chunks of 20000ms
2025-04-10 11:44:52,659 - INFO - [61326] - root - Created 3 audio chunks
2025-04-10 11:44:52,660 - INFO - [61326] - root - Processing audio chunk: /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmppuftri6j/processed_audio.wav_chunk_0.wav
2025-04-10 11:44:52,660 - INFO - [61326] - root - Processing audio chunk: /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmppuftri6j/processed_audio.wav_chunk_20000.wav
2025-04-10 11:44:52,661 - INFO - [61326] - root - Processing audio chunk: /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmppuftri6j/processed_audio.wav_chunk_40000.wav
2025-04-10 11:44:58,189 - INFO - [61326] - root - Serving index page
2025-04-10 11:44:58,191 - INFO - [61326] - werkzeug - 127.0.0.1 - - [10/Apr/2025 11:44:58] "GET / HTTP/1.1" 200 -
2025-04-10 11:44:58,682 - INFO - [61326] - httpx - HTTP Request: POST https://api.groq.com/openai/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-04-10 11:44:58,684 - INFO - [61326] - root - Removed chunk /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmppuftri6j/processed_audio.wav_chunk_40000.wav
2025-04-10 11:45:01,328 - INFO - [61326] - httpx - HTTP Request: POST https://api.fireworks.ai/inference/v1/completions "HTTP/1.1 200 OK"
2025-04-10 11:45:01,334 - INFO - [61326] - root - LLM processing completed in 8.7347 seconds
2025-04-10 11:45:01,334 - INFO - [61326] - root - Parsing refined text
2025-04-10 11:45:01,336 - INFO - [61326] - root - Total processing completed in 29.3941 seconds
2025-04-10 11:45:01,337 - INFO - [61326] - root - Removed processed file /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmpbkqvmlhb/processed_audio.wav
2025-04-10 11:45:01,338 - INFO - [61326] - root - Saving results to database
2025-04-10 11:45:01,368 - INFO - [61326] - root - Results saved to database with ID 187
2025-04-10 11:45:01,368 - INFO - [61326] - root - Database session closed
2025-04-10 11:45:01,369 - INFO - [61326] - werkzeug - 127.0.0.1 - - [10/Apr/2025 11:45:01] "POST /upload HTTP/1.1" 200 -
2025-04-10 11:45:02,544 - INFO - [61326] - httpx - HTTP Request: POST https://api.groq.com/openai/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-04-10 11:45:02,548 - INFO - [61326] - root - Removed chunk /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmppuftri6j/processed_audio.wav_chunk_0.wav
2025-04-10 11:45:02,549 - INFO - [61326] - root - Chunk 0 processing completed
2025-04-10 11:45:03,102 - INFO - [61326] - httpx - HTTP Request: POST https://api.groq.com/openai/v1/audio/transcriptions "HTTP/1.1 200 OK"
2025-04-10 11:45:03,104 - INFO - [61326] - root - Removed chunk /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmppuftri6j/processed_audio.wav_chunk_20000.wav
2025-04-10 11:45:03,104 - INFO - [61326] - root - Chunk 1 processing completed
2025-04-10 11:45:03,104 - INFO - [61326] - root - Chunk 2 processing completed
2025-04-10 11:45:03,104 - INFO - [61326] - root - Parallel processing completed, combined text length: 450
2025-04-10 11:45:03,104 - INFO - [61326] - root - Audio transcription completed in 10.4567 seconds, text length: 450
2025-04-10 11:45:03,104 - INFO - [61326] - root - Starting LLM processing
2025-04-10 11:45:06,162 - INFO - [61326] - httpx - HTTP Request: POST https://api.fireworks.ai/inference/v1/completions "HTTP/1.1 200 OK"
2025-04-10 11:45:06,164 - INFO - [61326] - root - LLM refining processing completed in 3.0593 seconds
2025-04-10 11:45:06,164 - INFO - [61326] - root - Starting LLM processing
2025-04-10 11:45:12,776 - INFO - [61326] - httpx - HTTP Request: POST https://api.fireworks.ai/inference/v1/completions "HTTP/1.1 200 OK"
2025-04-10 11:45:12,779 - INFO - [61326] - root - LLM translation processing completed in 6.6153 seconds
2025-04-10 11:45:12,779 - INFO - [61326] - root - Starting LLM processing
2025-04-10 11:45:28,094 - ERROR - [61326] - root - Error in batch processing: LLM processing failed: [Errno 54] Connection reset by peer
Traceback (most recent call last):
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpx/_transports/default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 256, in handle_request
    raise exc from None
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 101, in handle_request
    raise exc
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 78, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 156, in _connect
    stream = stream.start_tls(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 154, in start_tls
    with map_exceptions(exc_map):
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 54] Connection reset by peer

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/muhammedamr/Desktop/AHBS/Voice recognition/src/llm_service.py", line 309, in extract_features
    response = fireworks.client.Completion.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/fireworks/client/base_completion.py", line 81, in create
    return cls._create_non_streaming(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/fireworks/client/base_completion.py", line 180, in _create_non_streaming
    response = client.post_request_non_streaming(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/fireworks/client/api_client.py", line 159, in post_request_non_streaming
    response = self._client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpx/_client.py", line 1144, in post
    return self.request(
           ^^^^^^^^^^^^^
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpx/_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpx/_client.py", line 914, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpx/_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpx/_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpx/_transports/default.py", line 249, in handle_request
    with map_httpcore_exceptions():
  File "/opt/homebrew/Cellar/python@3.11/3.11.11/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/Users/muhammedamr/Desktop/AHBS/Refined_whisper/venv/lib/python3.11/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 54] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/muhammedamr/Desktop/AHBS/Voice recognition/test.py", line 438, in upload
    features_with_reasoning = LLMService.extract_features(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/muhammedamr/Desktop/AHBS/Voice recognition/src/llm_service.py", line 321, in extract_features
    raise Exception(f"LLM processing failed: {str(e)}")
Exception: LLM processing failed: [Errno 54] Connection reset by peer
2025-04-10 11:45:28,112 - INFO - [61326] - root - Database session rolled back
2025-04-10 11:45:28,112 - INFO - [61326] - root - Cleaned up file uploads/781bd142692744f3990fdb45e9dcadcb.m4a
2025-04-10 11:45:28,114 - INFO - [61326] - root - Removed processed file /var/folders/9h/zs4mvmp91456_d2n2hqf6wzc0000gn/T/tmppuftri6j/processed_audio.wav
2025-04-10 11:45:28,122 - INFO - [61326] - root - Database session closed
2025-04-10 11:45:28,123 - INFO - [61326] - werkzeug - 127.0.0.1 - - [10/Apr/2025 11:45:28] "[35m[1mPOST /upload HTTP/1.1[0m" 500 -
2025-04-10 11:47:06,514 - INFO - [61326] - werkzeug -  * Detected change in '/Users/muhammedamr/Desktop/AHBS/Voice recognition/test.py', reloading
